[
  {
    "vulnerability_base_name": "CWE78_OS_Command_Injection__char_connect_socket_execl_11",
    "bad_flow": [
      {
        "name": "CWE78_OS_Command_Injection__char_connect_socket_execl_11_bad",
        "address": "001014e9",
        "external": false,
        "code": "\nvoid FUN_001014e9(void)\n\n{\n  int iVar1;\n  int iVar2;\n  size_t sVar3;\n  ssize_t sVar4;\n  char *pcVar5;\n  long in_FS_OFFSET;\n  sockaddr local_88;\n  char local_78 [104];\n  long local_10;\n  \n  local_10 = *(long *)(in_FS_OFFSET + 0x28);\n  builtin_strncpy(local_78,\"ls \",4);\n  local_78[4] = '\\0';\n  local_78[5] = '\\0';\n  local_78[6] = '\\0';\n  local_78[7] = '\\0';\n  local_78[8] = '\\0';\n  local_78[9] = '\\0';\n  local_78[10] = '\\0';\n  local_78[0xb] = '\\0';\n  local_78[0xc] = '\\0';\n  local_78[0xd] = '\\0';\n  local_78[0xe] = '\\0';\n  local_78[0xf] = '\\0';\n  local_78[0x10] = '\\0';\n  local_78[0x11] = '\\0';\n  local_78[0x12] = '\\0';\n  local_78[0x13] = '\\0';\n  local_78[0x14] = '\\0';\n  local_78[0x15] = '\\0';\n  local_78[0x16] = '\\0';\n  local_78[0x17] = '\\0';\n  local_78[0x18] = '\\0';\n  local_78[0x19] = '\\0';\n  local_78[0x1a] = '\\0';\n  local_78[0x1b] = '\\0';\n  local_78[0x1c] = '\\0';\n  local_78[0x1d] = '\\0';\n  local_78[0x1e] = '\\0';\n  local_78[0x1f] = '\\0';\n  local_78[0x20] = '\\0';\n  local_78[0x21] = '\\0';\n  local_78[0x22] = '\\0';\n  local_78[0x23] = '\\0';\n  local_78[0x24] = '\\0';\n  local_78[0x25] = '\\0';\n  local_78[0x26] = '\\0';\n  local_78[0x27] = '\\0';\n  local_78[0x28] = '\\0';\n  local_78[0x29] = '\\0';\n  local_78[0x2a] = '\\0';\n  local_78[0x2b] = '\\0';\n  local_78[0x2c] = '\\0';\n  local_78[0x2d] = '\\0';\n  local_78[0x2e] = '\\0';\n  local_78[0x2f] = '\\0';\n  local_78[0x30] = '\\0';\n  local_78[0x31] = '\\0';\n  local_78[0x32] = '\\0';\n  local_78[0x33] = '\\0';\n  local_78[0x34] = '\\0';\n  local_78[0x35] = '\\0';\n  local_78[0x36] = '\\0';\n  local_78[0x37] = '\\0';\n  local_78[0x38] = '\\0';\n  local_78[0x39] = '\\0';\n  local_78[0x3a] = '\\0';\n  local_78[0x3b] = '\\0';\n  local_78[0x3c] = '\\0';\n  local_78[0x3d] = '\\0';\n  local_78[0x3e] = '\\0';\n  local_78[0x3f] = '\\0';\n  local_78[0x40] = '\\0';\n  local_78[0x41] = '\\0';\n  local_78[0x42] = '\\0';\n  local_78[0x43] = '\\0';\n  local_78[0x44] = '\\0';\n  local_78[0x45] = '\\0';\n  local_78[0x46] = '\\0';\n  local_78[0x47] = '\\0';\n  local_78[0x48] = '\\0';\n  local_78[0x49] = '\\0';\n  local_78[0x4a] = '\\0';\n  local_78[0x4b] = '\\0';\n  local_78[0x4c] = '\\0';\n  local_78[0x4d] = '\\0';\n  local_78[0x4e] = '\\0';\n  local_78[0x4f] = '\\0';\n  local_78[0x50] = '\\0';\n  local_78[0x51] = '\\0';\n  local_78[0x52] = '\\0';\n  local_78[0x53] = '\\0';\n  local_78[0x54] = '\\0';\n  local_78[0x55] = '\\0';\n  local_78[0x56] = '\\0';\n  local_78[0x57] = '\\0';\n  local_78[0x58] = '\\0';\n  local_78[0x59] = '\\0';\n  local_78[0x5a] = '\\0';\n  local_78[0x5b] = '\\0';\n  local_78[0x5c] = '\\0';\n  local_78[0x5d] = '\\0';\n  local_78[0x5e] = '\\0';\n  local_78[0x5f] = '\\0';\n  local_78[0x60] = '\\0';\n  local_78[0x61] = '\\0';\n  local_78[0x62] = '\\0';\n  local_78[99] = '\\0';\n  iVar1 = FUN_00101f2b();\n  if (iVar1 != 0) {\n    sVar3 = strlen(local_78);\n    iVar1 = socket(2,1,6);\n    if (iVar1 != -1) {\n      memset(&local_88,0,0x10);\n      local_88.sa_family = 2;\n      local_88.sa_data._2_4_ = inet_addr(\"127.0.0.1\");\n      local_88.sa_data._0_2_ = htons(0x6987);\n      iVar2 = connect(iVar1,&local_88,0x10);\n      if (iVar2 != -1) {\n        sVar4 = recv(iVar1,local_78 + sVar3,99 - sVar3,0);\n        iVar2 = (int)sVar4;\n        if ((iVar2 != -1) && (iVar2 != 0)) {\n          local_78[(long)iVar2 + sVar3] = '\\0';\n          pcVar5 = strchr(local_78,0xd);\n          if (pcVar5 != (char *)0x0) {\n            *pcVar5 = '\\0';\n          }\n          pcVar5 = strchr(local_78,10);\n          if (pcVar5 != (char *)0x0) {\n            *pcVar5 = '\\0';\n          }\n        }\n      }\n    }\n    if (iVar1 != -1) {\n      close(iVar1);\n    }\n  }\n  execl(\"/bin/sh\",\"/bin/sh\",&DAT_0010300e,local_78,0);\n  if (local_10 == *(long *)(in_FS_OFFSET + 0x28)) {\n    return;\n  }\n                    /* WARNING: Subroutine does not return */\n  __stack_chk_fail();\n}\n\n"
      },
      {
        "name": "execl",
        "address": "001013a0",
        "external": true,
        "code": "",
        "edge": {
          "from": "FUN_001014e9",
          "to": "execl",
          "site": "00101750"
        }
      }
    ],
    "good_flow": [
      {
        "name": "goodG2B1",
        "address": "0010176c",
        "external": false,
        "code": "\nvoid FUN_0010176c(void)\n\n{\n  int iVar1;\n  size_t sVar2;\n  long in_FS_OFFSET;\n  char local_78 [104];\n  long local_10;\n  \n  local_10 = *(long *)(in_FS_OFFSET + 0x28);\n  builtin_strncpy(local_78,\"ls \",4);\n  local_78[4] = '\\0';\n  local_78[5] = '\\0';\n  local_78[6] = '\\0';\n  local_78[7] = '\\0';\n  local_78[8] = '\\0';\n  local_78[9] = '\\0';\n  local_78[10] = '\\0';\n  local_78[0xb] = '\\0';\n  local_78[0xc] = '\\0';\n  local_78[0xd] = '\\0';\n  local_78[0xe] = '\\0';\n  local_78[0xf] = '\\0';\n  local_78[0x10] = '\\0';\n  local_78[0x11] = '\\0';\n  local_78[0x12] = '\\0';\n  local_78[0x13] = '\\0';\n  local_78[0x14] = '\\0';\n  local_78[0x15] = '\\0';\n  local_78[0x16] = '\\0';\n  local_78[0x17] = '\\0';\n  local_78[0x18] = '\\0';\n  local_78[0x19] = '\\0';\n  local_78[0x1a] = '\\0';\n  local_78[0x1b] = '\\0';\n  local_78[0x1c] = '\\0';\n  local_78[0x1d] = '\\0';\n  local_78[0x1e] = '\\0';\n  local_78[0x1f] = '\\0';\n  local_78[0x20] = '\\0';\n  local_78[0x21] = '\\0';\n  local_78[0x22] = '\\0';\n  local_78[0x23] = '\\0';\n  local_78[0x24] = '\\0';\n  local_78[0x25] = '\\0';\n  local_78[0x26] = '\\0';\n  local_78[0x27] = '\\0';\n  local_78[0x28] = '\\0';\n  local_78[0x29] = '\\0';\n  local_78[0x2a] = '\\0';\n  local_78[0x2b] = '\\0';\n  local_78[0x2c] = '\\0';\n  local_78[0x2d] = '\\0';\n  local_78[0x2e] = '\\0';\n  local_78[0x2f] = '\\0';\n  local_78[0x30] = '\\0';\n  local_78[0x31] = '\\0';\n  local_78[0x32] = '\\0';\n  local_78[0x33] = '\\0';\n  local_78[0x34] = '\\0';\n  local_78[0x35] = '\\0';\n  local_78[0x36] = '\\0';\n  local_78[0x37] = '\\0';\n  local_78[0x38] = '\\0';\n  local_78[0x39] = '\\0';\n  local_78[0x3a] = '\\0';\n  local_78[0x3b] = '\\0';\n  local_78[0x3c] = '\\0';\n  local_78[0x3d] = '\\0';\n  local_78[0x3e] = '\\0';\n  local_78[0x3f] = '\\0';\n  local_78[0x40] = '\\0';\n  local_78[0x41] = '\\0';\n  local_78[0x42] = '\\0';\n  local_78[0x43] = '\\0';\n  local_78[0x44] = '\\0';\n  local_78[0x45] = '\\0';\n  local_78[0x46] = '\\0';\n  local_78[0x47] = '\\0';\n  local_78[0x48] = '\\0';\n  local_78[0x49] = '\\0';\n  local_78[0x4a] = '\\0';\n  local_78[0x4b] = '\\0';\n  local_78[0x4c] = '\\0';\n  local_78[0x4d] = '\\0';\n  local_78[0x4e] = '\\0';\n  local_78[0x4f] = '\\0';\n  local_78[0x50] = '\\0';\n  local_78[0x51] = '\\0';\n  local_78[0x52] = '\\0';\n  local_78[0x53] = '\\0';\n  local_78[0x54] = '\\0';\n  local_78[0x55] = '\\0';\n  local_78[0x56] = '\\0';\n  local_78[0x57] = '\\0';\n  local_78[0x58] = '\\0';\n  local_78[0x59] = '\\0';\n  local_78[0x5a] = '\\0';\n  local_78[0x5b] = '\\0';\n  local_78[0x5c] = '\\0';\n  local_78[0x5d] = '\\0';\n  local_78[0x5e] = '\\0';\n  local_78[0x5f] = '\\0';\n  local_78[0x60] = '\\0';\n  local_78[0x61] = '\\0';\n  local_78[0x62] = '\\0';\n  local_78[99] = '\\0';\n  iVar1 = FUN_00101f3a();\n  if (iVar1 == 0) {\n    sVar2 = strlen(local_78);\n    builtin_strncpy(local_78 + sVar2,\"*.*\",4);\n  }\n  else {\n    FUN_00101a17(\"Benign, fixed string\");\n  }\n  execl(\"/bin/sh\",\"/bin/sh\",&DAT_0010300e,local_78,0);\n  if (local_10 != *(long *)(in_FS_OFFSET + 0x28)) {\n                    /* WARNING: Subroutine does not return */\n    __stack_chk_fail();\n  }\n  return;\n}\n\n"
      },
      {
        "name": "execl",
        "address": "001013a0",
        "external": true,
        "code": "",
        "edge": {
          "from": "FUN_0010176c",
          "to": "execl",
          "site": "00101861"
        }
      }
    ]
  }
]